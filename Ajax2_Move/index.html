<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        ul {
            list-style: none;
        }

        form ul li label input {
            margin-bottom: 10px;
        }
        .styleDetails{
            width: 100px;
            height: 40px;
            font-family: sans-serif;
            font-size: 18px;
        }
        .styleDetailsLi{
            font-family: sans-serif;
            font-size: 18px;
        }
        .FilmsStyle{
            font-family: sans-serif;
            width: 400px;
            height: 300px;
            margin: auto;
            display: flex;
            padding: 10px;
        }
        .FilmsStyleIMG{
            width: 200px;
            height: 300px;
        }
        .FilmsStyleBtnDetails{

        }



    </style>
</head>
<body>

<div style="border: 1px solid black;
    border-radius: 10px;
    padding: 5px;
    width: fit-content;
    margin: auto;">
    <form name = "formSetSearch" method = "get">
        <ul style="padding: 10px; margin: 0;">
            <li>
                <label>Title:
                    <input id="SearchTitle" type="text">
                </label>
            </li>
            <li>
                <label>Type:
                    <select id="SelectType">
                        <option>movie</option>
                        <option>series</option>
                        <option>episode</option>
                    </select>
                </label>
            </li>

        </ul>
        <input style="width: -webkit-fill-available;" value="SearchBtn"  type="submit" >
    </form>
</div>
<div>
    <p>Films</p>
</div>
<div>
    <ul id="OutSearch" style="
    padding: 0px; margin: 0;
    display: flex;;
    background-color: antiquewhite;
    flex-wrap: wrap;">

    </ul>
</div>
<form id="Select_position">
    <input type="submit"  name="LeftSelect" value="<<">
    <input type="submit"  name="RightSelect" value=">>">
</form>
<div id="Details" style="
background-color: antiquewhite;
    padding: 10px;
    ">
</div>

<script>
    // Краще називати змінні з префіксом frm для форм, btn для кнопок, inp для інпутів і т.д.
    // Це покращує читабельність коду.
    // Такой стиль має назву "convention over configuration".
    // Yes — that's essentially a Hungarian-style naming convention (prefixes encoding the role/type).
    // Traditional Hungarian notation encoded data types or semantics; using frm, btn, inp for UI elements
    // is a common, lightweight "UI prefix" convention (Hungarian-like).
    const frmSearch = document.forms['formSetSearch'];




    const API_KEY = '53cc027b';
    const BASE_API_URL = `http://www.omdbapi.com/?apikey=${API_KEY}`;
    const BASE_IMG_URL = `http://img.omdbapi.com/?apikey=${API_KEY}`;

    // const searchTitle = document.getElementById("SearchTitle");
    // searchTitle.value => search;


    /**
     * Функція для отримання фільмів за назвою
     */
    function getMovie() {
        let url;
        let search = document.getElementById("SearchTitle").value;

        if (search !== "") {
            url = `${BASE_API_URL}&s=${search}`;
        }
        else {
            alert("Please enter a search term");
            return;
        }
        fetch(url)
            // Краще перевіряти response.ok і викидати помилку, якщо відповідь не ок
            .then(response => {
                if (!response.ok) {
                    alert(response.message);
                    return;
                }
                return response.json();
            })
            .then(data => {
                console.log(data);
                console.log(data.Search);

                // Очищати попередні результати перед виводом нових
                document.getElementById('OutSearch').innerHTML = '';

                // Перевіряти, що там щось взагалі є - и то массив
                data.Search.forEach((item) => {
                    let html = `
                        <li class="FilmsStyle">
                        <img class="FilmsStyleIMG" src="${item.Poster}" alt="${item.Title}">
                            <ul>

                                <li><p> ${item.Type}</p></li>
                                <li><h2>${item.Title}</h2></li>
                                <li><p>${item.Year}</p></li>
                                <li CLASS="FilmsStyleBtnDetails"><button
                                class="btnDetails"
                                onclick="getDetails(event)"
                                    data-imdbID="${item.imdbID}"
                                    data-title="${item.Title}">
                                Details</button></li>
                            </ul>


                        </li>
                        `
                    document.getElementById('OutSearch').innerHTML += html;
                })

            })
            .catch(error => {
                console.log(error);
            })
    }

    /**
     * Отримання деталей фільму
     * @param ev
     */

    function getDetails(ev)
    {
        console.log(ev);
        let imdbID = ev.target.getAttribute('data-imdbID');
        let title = ev.target.getAttribute('data-title');
        let url = `${BASE_API_URL}&i=${imdbID}`;
        fetch(url)
            // Краще перевіряти response.ok і викидати помилку, якщо відповідь не ок
            .then(response => {
                if (!response.ok) {
                    alert(response.message);
                    return;
                }
                return response.json();
            })
            .then(data => {
                console.log(data);
                document.getElementById('Details').innerHTML = '';
                let html = `
                    <ul style="display: flex;">
                        <li>
                            <img style="width: 400px;height: 650px;" src="${data.Poster}"
                            alt="${data.Title}">
                        </li>
                        <li style="height: fit-content;">
                            <ul>
                                <ul style="display: flex;">
                                    <li class="styleDetails">Title       :</li>
                                    <li class="styleDetailsLi">${data.Title}</li>
                                </ul>

                                <ul style="display: flex;">
                                    <li class="styleDetails">Released    :</li>
                                    <li class="styleDetailsLi">${data.Released}</li>
                                </ul>

                                <ul style="display: flex;">
                                    <li class="styleDetails">Genre :</li>
                                    <li class="styleDetailsLi">${data.Genre}</li>
                                </ul>

                                <ul style="display: flex;">
                                    <li class="styleDetails">Country :</li>
                                    <li class="styleDetailsLi">${data.Country}</li>
                                </ul>

                                <ul style="display: flex;">
                                    <li class="styleDetails">Director :</li>
                                    <li class="styleDetailsLi">${data.Director}</li>
                                </ul>

                                <ul style="display: flex;">
                                    <li class="styleDetails">Writer :</li>
                                    <li class="styleDetailsLi">${data.Writer}</li>
                                </ul>

                                <ul style="display: flex;">
                                    <li class="styleDetails">Actors :</li>
                                    <li class="styleDetailsLi">${data.Actors}</li>
                                </ul>

                                <ul style="display: flex;">
                                    <li class="styleDetails">Awards :</li>
                                    <li class="styleDetailsLi">${data.Awards}</li>
                                </ul>

                            </ul>
                        </li>
                    </ul>

                    `
                document.getElementById('Details').innerHTML = html;
            })
        .catch(error => {
            console.log(error);
        })

    }



    frmSearch.onsubmit = function (ev) {
        ev.preventDefault();
        getMovie()
        return false
    }


</script>
</body>
</html>